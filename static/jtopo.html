<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<script src="/TopologyPrj/js/jquery-3.1.0.min.js"></script>
<script src="/TopologyPrj/js/jtopo-0.4.8-min.js"></script>
<script src="/TopologyPrj/js/toolbar.js"></script>
<body>
<canvas id="canvas"></canvas>
</body>
<script>
    $(document).ready(function(){
        var canvas = document.getElementById('canvas');
        canvas.width = 1500;
        canvas.height = 1000;
        var stage = new JTopo.Stage(canvas);
        //显示工具栏
//        showJTopoToobar(stage);

        var scene = new JTopo.Scene();
//        scene.background = './img/bg.jpg';

        function node(x, y, img){
            var node = new JTopo.Node();
            node.setImage(img, true);
            node.setLocation(x, y);
            scene.add(node);
            return node;
        }

        function linkNode(nodeA, nodeZ, f){
            var link;
            if(f){
                link = new JTopo.FoldLink(nodeA, nodeZ);
            }else{
                link = new JTopo.Link(nodeA, nodeZ);
            }
            link.direction = 'vertical';
            scene.add(link);
            return link;
        }

        var s1 = node(305, 43, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        s1.alarm = '2 W';
        var s2 = node(365, 43, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        var s3 = node(425, 43, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');

        var g1 = node(366, 125, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        linkNode(s1, g1, true);
        linkNode(s2, g1, true);
        linkNode(s3, g1, true);

        var w1 = node(324, 167, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        linkNode(g1, w1);

        var c1 = node(364, 214, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        linkNode(w1, c1);

        var cloud = node(344, 259, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        linkNode(c1, cloud);

        var c2 = node(364, 328, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        linkNode(cloud, c2);

        var w2 = node(324, 377, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        linkNode(c2, w2);

        var g2 = node(366, 411, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        linkNode(w2, g2);

        function hostLink(nodeA, nodeZ){
            var link = new JTopo.FlexionalLink(nodeA, nodeZ);
            link.shadow = false;
            link.offsetGap = 44;
            scene.add(link);
            return link;
        }

        var h1 = node(218, 520, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        h1.alarm = '';
        hostLink(g2, h1);
        var h2 = node(292, 520, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        hostLink(g2, h2);
        var h3 = node(366, 520, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        h3.alarm = '二级告警';
        hostLink(g2, h3);
        var h4 = node(447, 520, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        hostLink(g2, h4);
        var h5 = node(515, 520, 'https://console.ustack.com/static/modules/instance/i/icon-network.png');
        h5.alarm = '1M';
        hostLink(g2, h5);

        setInterval(function(){
            if(h3.alarm == '二级告警'){
                h3.alarm = null;
            }else{
                h3.alarm = '二级告警'
            }
        }, 600);

        stage.add(scene);
    });

</script>

</html>